BACKUP DATABASE [ADVENTUREWORKS2022] TO  DISK = N'C:\BACKUP TEST\SNOOP.BAK' WITH NOFORMAT, INIT,  NAME = N'ADVENTUREWORKS2022-FULL DATABASE BACKUP', SKIP, NOREWIND, NOUNLOAD, COMPRESSION,  STATS = 10, CHECKSUM
GO

DECLARE @BACKUPSETID AS INT
SELECT @BACKUPSETID = POSITION FROM MSDB..BACKUPSET WHERE DATABASE_NAME=N'ADVENTUREWORKS2022' AND BACKUP_SET_ID=(SELECT MAX(BACKUP_SET_ID) 
FROM MSDB..BACKUPSET 
WHERE DATABASE_NAME=N'ADVENTUREWORKS2022' )


IF @BACKUPSETID IS NULL BEGIN RAISERROR(N'VERIFY FAILED. BACKUP INFORMATION FOR DATABASE ''ADVENTUREWORKS2022'' NOT FOUND.', 16, 1) END
RESTORE VERIFYONLY FROM  DISK = N'C:\BACKUP TEST\SNOOP.BAK' WITH  FILE = @BACKUPSETID,  NOUNLOAD,  NOREWIND
GO


RESTORE VERIFYONLY
FROM DISK = N'C:\BACKUP TEST\SNOOP.BAK'
WITH CHECKSUM;
GO


